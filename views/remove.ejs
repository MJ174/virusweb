<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />

    <title>매크로 제거</title>
    <style>
      body {
        background-color: #f8f9fa; /* Light background for contrast */
      }
      .card-header {
        background-color: #647180; /* Bootstrap primary color */
        color: white; /* White text */
      }
      .btn-custom {
        background-color: #647180; /* Custom button color */
        color: white; /* White text for better contrast */
      }
      .result-message {
        font-size: 1.2rem; /* Increase font size */
        margin-top: 1rem;
      }
    </style>
</head>
<body>
    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
        <a class="my-0 mr-md-auto font-weight-normal p-0 text-dark" href="/" style="font-size: 1rem;">
            <img class="mb-4" src="/public/css/home.png" alt="" width="60" />
        </a>
        <%- include('nav.html') %>
        <a href="/login">
            <button class="btn btn-outline-primary" type="button">로그인</button>
        </a>
    </div>

    <div class="container mt-5">
        <form action="/macroscan/removeupload" method="post" enctype="multipart/form-data" onsubmit="return validateFileName()">
            <div class="card mb-4 shadow-sm">
                <div class="card-header">
                    <h4 class="my-0 font-weight-normal">VBA 매크로 제거</h4>
                </div>
                <div class="card-body text-center">
                    <h5 class="card-title">매크로를 제거할 문서 파일을 올려주세요</h5>
                    <div class="mb-3">
                        <input type="file" name="file" accept=".doc,.docx,.ppt,.pptx,.xls,.xlsx,.xlsm,.pdf" class="form-control-file" />
                    </div>
                    <button type="submit" class="btn btn-custom btn-lg">파일 제출</button>
                </div>
            </div>
        </form>

        <!-- 결과 메시지 영역 -->
        <div class="result-message text-center">
            <h3>제거 결과</h3>
            <p>파일이 성공적으로 업로드되었습니다. 매크로 제거 프로세스를 진행 중입니다...</p>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <script>
      function validateFileName() {
          const fileInput = document.querySelector('input[name="file"]');
          const fileName = fileInput.value;
          const disallowedCharacters = /[!@#$%^&*(),?"{}|<>]/; // 특수 기호 거부

          if (disallowedCharacters.test(fileName)) {
              alert("파일명에 특수 기호가 포함되어 있습니다.");
              return false; // 파일 업로드를 중단하기 위해 false를 반환합니다.
          }
          return true; // 파일 업로드를 진행할 수 있음을 나타내기 위해 true를 반환합니다.
      }
    </script>
</body>
</html>
